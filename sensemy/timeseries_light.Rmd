---
title: "Time series light top way_ids"
output: html_notebook
---

```{r echo=FALSE}
m_top50 <- m
m_top50
```

```{r echo=FALSE, message=FALSE}
tseries_light <- function(index) { df_superhotedges_april16pt %>% 
  filter( way_id == list_osm_edge[index] ) %>% 
  ggplot(aes(x= time, y= (speed*18)/5)) + 
  geom_point(aes(colour = class), alpha = 1/10) + 
  ylab("Speed(km/h)") + 
  xlab("Date")+ 
  ggtitle(paste("Time series of speed for way_id",list_osm_edge[index], sep = " " ))}


```

```{r echo=FALSE}
lapply(1:12, FUN = tseries_light)
```

#Timeseries 

## Speed  
```{r}
#Boxplots all 
df_superhotedges_april16pt %>% 
  filter(speed > 0) %>% 
  group_by(hour = hour(time)) %>% 
  plot_ly(x= ~hour, y= ~(speed*18)/5, type = 'box',boxpoints = FALSE) %>% 
  layout(title = paste("Avg speed per hour" ),
         yaxis = list(title="Speed (km/h)"),
         xaxis = list(title="Hour"))
```

## All timeseries per way_id

```{r echo=FALSE, message=FALSE}
lapply(1:12, FUN = tseries)
```

## Boxplot intersession time  
```{r}
#Boxplots all 
df_intersession_april16pt %>%
  subset(way_id %in% df_superhotedges_april16pt$way_id) %>% 
  ggplot(aes(factor(way_id), intersession_time)) +
  geom_boxplot() +
  coord_cartesian(ylim= c(0,250))+
  ggtitle(label = "Intersession time top 12 edges") + 
  xlab("") + 
  ylab("Time (min)") +
  theme(axis.text.x=element_text(angle=45,hjust=1,vjust=0.5))
  

```

# Individual plots

## Timeseries speed average per way_id

```{r echo=FALSE, message=FALSE}
lapply(1:12, FUN = tseries_speed)
```

### Per week. 
```{r echo=FALSE, message=FALSE}
lapply(1:12, FUN = tseries_avg_w)
```

### Per hour. 
```{r echo=FALSE, message=FALSE}
lapply(1:12, FUN = tseries_avg_h)
```

### Per day.
```{r echo=FALSE, message=FALSE}
lapply(1:12, FUN = tseries_avg_d)
```




## Number of sessions 
### Timeseries speed average per way_id

```{r echo=FALSE, message=FALSE}
lapply(1:12, FUN = tseries_nsession)
```


## Intersession time 

```{r}
lapply(1:12, FUN = inter_h)
```







## Avg speed different.

```{r echo=FALSE}
lapply(1:12, FUN = newspeed_avg)
```


## Standard deviation day and hour

```{r echo=FALSE}
lapply(1:12, FUN = sd_day_h)
```





























